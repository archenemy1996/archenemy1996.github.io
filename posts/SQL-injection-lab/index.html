<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="SQL Injection LAB" /><meta property="og:locale" content="en" /><meta name="description" content="It’s a write-up about the room : Try Hack Me - Room : SQL Injection LAB" /><meta property="og:description" content="It’s a write-up about the room : Try Hack Me - Room : SQL Injection LAB" /><link rel="canonical" href="https://archenemy1996.github.io/posts/SQL-injection-lab/" /><meta property="og:url" content="https://archenemy1996.github.io/posts/SQL-injection-lab/" /><meta property="og:site_name" content="Chirpy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-08T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SQL Injection LAB" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-02T12:46:41+00:00","datePublished":"2023-08-08T00:00:00+00:00","description":"It’s a write-up about the room : Try Hack Me - Room : SQL Injection LAB","headline":"SQL Injection LAB","mainEntityOfPage":{"@type":"WebPage","@id":"https://archenemy1996.github.io/posts/SQL-injection-lab/"},"url":"https://archenemy1996.github.io/posts/SQL-injection-lab/"}</script><title>SQL Injection LAB | Chirpy</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chirpy"><meta name="application-name" content="Chirpy"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Chirpy</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/github_username" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SQL Injection LAB</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>SQL Injection LAB</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">your_full_name</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1691452800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-08-08 </em> </span> <span> Updated <em class="timeago" data-ts="1717332401" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-06-02 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1453 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>It’s a write-up about the room : <a href="https://tryhackme.com/room/sqlilab">Try Hack Me - Room : SQL Injection LAB</a></p><h1 id="task-1--introduction">Task 1 : Introduction</h1><p>This room is meant as an introduction to SQL injection and demonstrates various SQL injection attacks.</p><h3 id="questions"><span class="mr-2">Questions</span><a href="#questions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Deploy the machine</strong></p><h1 id="task-2--introduction-to-sql-injection-part-1">Task 2 : Introduction to SQL Injection: Part 1</h1><p>SQL injection is a technique through which attackers can execute their own malicious SQL statements generally referred to as a malicious payload. Through the malicious SQL statements, attackers can steal information from the victim’s database; even worse, they may be able to make changes to the database. Our employee management web application has SQL injection vulnerabilities, which mimic the mistakes frequently made by developers.</p><p>Applications will often need dynamic SQL queries to be able to display content based on different conditions set by the user. To allow for dynamic SQL queries, developers often concatenate user input directly into the SQL statement. Without checks on the received input, string concatenation becomes the most common mistake that leads to SQL injection vulnerability. Without input sanitization, the user can make the database interpret the user input as a SQL statement instead of as data. In other words, the attacker must have access to a parameter that they can control, which goes into the SQL statement. With control of a parameter, the attacker can inject a malicious query, which will be executed by the database. If the application does not sanitize the given input from the attacker-controlled parameter, the query will be vulnerable to SQL injection attack.</p><p>The following PHP code demonstrates a dynamic SQL query in a login from. The user and password variables from the POST request is concatenated directly into the SQL statement.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * FROM users WHERE username='"</span> <span class="o">+</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"user"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"' AND password= '"</span> <span class="o">+</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span><span class="err">$</span> <span class="o">+</span> <span class="err">'</span><span class="s2">";"</span>
</pre></table></code></div></div><p>If the attacker supplies the value</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' OR 1=1-- - 
</span></pre></table></code></div></div><p>inside the name parameter, the query might return more than one user. Most applications will process the first user returned, meaning that the attacker can exploit this and log in as the first user the query returned. The double-dash <code class="language-plaintext highlighter-rouge">(--)</code> sequence is a comment indicator in SQL and causes the rest of the query to be commented out. In SQL, a string is enclosed within either a single quote <code class="language-plaintext highlighter-rouge">(')</code> or a double quote <code class="language-plaintext highlighter-rouge">(")</code>. The single quote <code class="language-plaintext highlighter-rouge">(')</code> in the input is used to close the string literal. If the attacker enters</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' OR 1=1-- - 
</span></pre></table></code></div></div><p>in the name parameter and leaves the password blank, the query above will result in the following SQL statement.</p><p><code class="language-plaintext highlighter-rouge">' OR 1=1-- -</code>, the <code class="language-plaintext highlighter-rouge">OR 1=1</code> part is attempting to inject a condition that is always true, effectively bypassing any password check in the query. Then, <code class="language-plaintext highlighter-rouge">-- -</code> is used to comment out the rest of the query, including any subsequent parts that might be added to prevent the injection.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="no">SELECT</span> <span class="o">*</span> <span class="no">FROM</span> <span class="n">users</span> <span class="no">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="s1">''</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">--</span> <span class="o">-</span><span class="s1">' AND password = '</span><span class="err">'</span>
</pre></table></code></div></div><p>If the database executes the SQL statement above, all the users in the users table are returned. Consequently, the attacker bypasses the application’s authentication mechanism and is logged in as the first user returned by the query.</p><p>The reason for using <code class="language-plaintext highlighter-rouge">-- -</code> instead of <code class="language-plaintext highlighter-rouge">--</code> is primarily because of how MySQL handles the double-dash comment style.</p><p><strong>From a <code class="language-plaintext highlighter-rouge">--</code> sequence to the end of the line. In MySQL, the <code class="language-plaintext highlighter-rouge">--</code> (double-dash) comment style requires the second dash to be followed by at least one whitespace or control character (such as a space, tab, newline, and so on). This syntax differs slightly from standard SQL comment syntax, as discussed in Section <code class="language-plaintext highlighter-rouge">1.7.2.4, “'--' as the Start of a Comment”</code>.(dev.mysql.com)</strong></p><p>The safest solution for inline SQL comment is to use <code class="language-plaintext highlighter-rouge">--&lt;space&gt;&lt;any character&gt;</code> such as <code class="language-plaintext highlighter-rouge">-- -</code> because if it is URL-encoded into <code class="language-plaintext highlighter-rouge">--%20-</code> it will still be decoded as <code class="language-plaintext highlighter-rouge">-- -</code>. For more information, see: <strong>https://blog.raw.pm/en/sql-injection-mysql-comment/</strong></p><h2 id="sql-injection-1-input-box-non-string"><span class="mr-2">SQL Injection 1: Input Box Non-String</span><a href="#sql-injection-1-input-box-non-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>When a user logs in, the application performs the following query:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">uid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">profileID</span><span class="p">,</span> <span class="n">salary</span><span class="p">,</span> <span class="n">passportNr</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">nickName</span><span class="p">,</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="mi">10</span> <span class="k">AND</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'ce5ca67...'</span>
</pre></table></code></div></div><p>When logging in, the user supplies input to the profileID parameter. For this challenge, the parameter accepts an integer, as can be seen here:</p><p><code class="language-plaintext highlighter-rouge">profileID=10</code></p><p>Since there is no input sanitization, it is possible to bypass the login by using any True condition such as the one below as the ProfileID</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="mi">1</span> <span class="k">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">-- -</span>
</pre></table></code></div></div><p>Bypass the login and retrieve the flag.</p><h2 id="sql-injection-2-input-box-string"><span class="mr-2">SQL Injection 2: Input Box String</span><a href="#sql-injection-2-input-box-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge uses the same query as in the previous challenge. However, the parameter expects a string instead of an integer, as can be seen here:</p><p><code class="language-plaintext highlighter-rouge">profileID='10'</code></p><p>Since it expects a string, we need to modify our payload to bypass the login slightly. The following line will let us in:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' or '</span><span class="mi">1</span><span class="s1">'='</span><span class="mi">1</span><span class="s1">'-- -
</span></pre></table></code></div></div><p>Bypass the login and retrieve the flag.</p><h2 id="sql-injection-3-and-4-url-and-post-injection"><span class="mr-2">SQL Injection 3 and 4: URL and POST Injection</span><a href="#sql-injection-3-and-4-url-and-post-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Here, the SQL query is the same as the previous one:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">uid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">profileID</span><span class="p">,</span> <span class="n">salary</span><span class="p">,</span> <span class="n">passportNr</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">nickName</span><span class="p">,</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'10'</span> <span class="k">AND</span> <span class="n">password</span><span class="o">=</span><span class="s1">'ce5ca67...'</span>
</pre></table></code></div></div><p>But in this case, the malicious user input cannot be injected directly into the application via the login form because some client-side controls have been implemented:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">validateform</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">profileID</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">inputForm</span><span class="p">.</span><span class="nx">profileID</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">inputForm</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="sr">/^</span><span class="se">[</span><span class="sr">a-zA-Z0-9</span><span class="se">]</span><span class="sr">*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">profileID</span><span class="p">)</span> <span class="o">==</span> <span class="kc">false</span> <span class="o">||</span> <span class="sr">/^</span><span class="se">[</span><span class="sr">a-zA-Z0-9</span><span class="se">]</span><span class="sr">*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">The input fields cannot contain special characters</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">profileID</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">password</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">The input fields cannot be empty.</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The JavaScript code above requires that both the profileID and the password only contains characters between <code class="language-plaintext highlighter-rouge">a-z, A-Z, and 0-9</code>. Client-side controls are only there to improve the user experience and is in no way a security feature as the user has full control over the client and the data it submits. For example, a proxy tool such as Burp Suite can be used to bypass the client side JavaScript validation <code class="language-plaintext highlighter-rouge">(https://portswigger.net/support/using-burp-to-bypass-client-side-javascript-validation)</code>.</p><h2 id="sql-injection-3-url-injection"><span class="mr-2">SQL Injection 3: URL Injection</span><a href="#sql-injection-3-url-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge uses a GET request when submitting the login form, as seen here:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://MACHINE_IP:5000/sesqli3/login?profileID=a<span class="err">&amp;</span>password=a
</pre></table></code></div></div><p>The login and the client-side validation can then easily be bypassed by going directly to this URL:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://MACHINE_IP:5000/sesqli3/login?profileID=-1' or 1=1-- -<span class="err">&amp;</span>password=a
</pre></table></code></div></div><p>The browser will automatically urlencode this for us. Urlencoding is needed since the HTTP protocol does not support all characters in the request. When urlencoded, the URL looks as follows:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://MACHINE_IP:5000/sesqli3/login?profileID=-1%27%20or%201=1--%20-<span class="err">&amp;</span>password=a
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">%27</code> becomes the single quote <code class="language-plaintext highlighter-rouge">(')</code> character and <code class="language-plaintext highlighter-rouge">%20</code> becomes a blank space.</p><h2 id="sql-injection-4-post-injection"><span class="mr-2">SQL Injection 4: POST Injection</span><a href="#sql-injection-4-post-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>When submitting the login form for this challenge, it uses the HTTP POST method. It is possible to either remove/disable the JavaScript validating the login form or submit a valid request and intercept it with a proxy tool such as Burp Suite and modify it:</p><p><img data-src="/assets/img/SQL%20Injection%20LAB/SQL%20Injection%204%20post.png" alt="SQL Injection 4: POST Injection burp" data-proofer-ignore></p><h3 id="questions-1"><span class="mr-2">Questions:</span><a href="#questions-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h2 id="what-is-the-flag-for-sql-injection-1-input-box-non-string"><span class="mr-2">What is the flag for SQL Injection 1: Input Box Non-String?</span><a href="#what-is-the-flag-for-sql-injection-1-input-box-non-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Answer: THM{dccea429d73d4a6b4f117ac64724f460}</p><h2 id="what-is-the-flag-for-sql-injection-2-input-box-string"><span class="mr-2">What is the flag for SQL Injection 2: Input Box String?</span><a href="#what-is-the-flag-for-sql-injection-2-input-box-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Answer: THM{356e9de6016b9ac34e02df99a5f755ba}</p><h2 id="what-is-the-flag-for-sql-injection-3-url-injection"><span class="mr-2">What is the flag for SQL Injection 3: URL Injection?</span><a href="#what-is-the-flag-for-sql-injection-3-url-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Answer: THM{645eab5d34f81981f5705de54e8a9c36}</p><h2 id="what-is-the-flag-for-sql-injection-4-post-injection"><span class="mr-2">What is the flag for SQL Injection 4: POST Injection?</span><a href="#what-is-the-flag-for-sql-injection-4-post-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Answer: THM{727334fd0f0ea1b836a8d443f09dc8eb}</p><h1 id="task-3--introduction-to-sql-injection-part-2">Task 3 : Introduction to SQL Injection: Part 2</h1><h2 id="sql-injection-attack-on-an-update-statement"><span class="mr-2">SQL Injection Attack on an UPDATE Statement</span><a href="#sql-injection-attack-on-an-update-statement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>If a SQL injection occurs on an UPDATE statement, the damage can be much more severe as it allows one to change records within the database. In the employee management application, there is an edit profile page as depicted in the following figure.</p><p><img data-src="/assets/img/SQL%20Injection%20LAB/edit_admin_sqli.png" alt="SQL Injection Update sqli" data-proofer-ignore></p><p>This edit page allows the employees to update their information, but they do not have access to all the available fields, and the user can only change their information. If the form is vulnerable to SQL injection, an attacker can bypass the implemented logic and update fields they are not supposed to, or for other users.</p><p><img data-src="/assets/img/SQL%20Injection%20LAB/code_sqli_update.png" alt="SQL Injection Update sqli" data-proofer-ignore></p><p>We will now enumerate the database via the UPDATE statement on the profile page. We will assume we have no prior knowledge of the database. By looking at the web page’s source code, we can identify potential column names by looking at the name attribute. The columns don’t necessarily need to be named this, but there is a good chance of it, and column names such as “email” and “password” are not uncommon and can easily be guessed.</p><p>To confirm that the form is vulnerable and that we have working column names, we can try to inject something similar to the code below into the nickName and email field:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">asd</span><span class="s1">',nickName='</span><span class="n">test</span><span class="s1">',email='</span><span class="n">hacked</span>
</pre></table></code></div></div><p>When injecting the malicious payload into the nickName field, only the nickName is updated. When injected into the email field, both fields are updated:</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/write-ups/'>Write-Ups</a>, <a href='/categories/try-hack-me/'>Try Hack Me</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >TryHackMe</a> <a href="/tags/sql/" class="post-tag no-text-decoration" >SQL</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SQL Injection LAB - Chirpy&amp;url=https://archenemy1996.github.io/posts/SQL-injection-lab/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SQL Injection LAB - Chirpy&amp;u=https://archenemy1996.github.io/posts/SQL-injection-lab/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://archenemy1996.github.io/posts/SQL-injection-lab/&amp;text=SQL Injection LAB - Chirpy" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SQL-injection-lab/">SQL Injection LAB</a><li><a href="/posts/Regular_Expressions/">Regular Expressions</a><li><a href="/posts/OWASP-Broken-Access-Control/">Bash Scripting</a><li><a href="/posts/Intro-to-Docker/">Intro to Docker</a><li><a href="/posts/Python-for-Pentesters/">Python for Pentesters</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/bash/">Bash</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/note/">Note</a> <a class="post-tag" href="/tags/reference/">Reference</a> <a class="post-tag" href="/tags/wireshark/">Wireshark</a> <a class="post-tag" href="/tags/commands/">Commands</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/linux-commands/">Linux Commands</a> <a class="post-tag" href="/tags/linux-modules/">Linux Modules</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Encryption-Crypto-101/"><div class="card-body"> <em class="timeago small" data-ts="1716508800" > 2024-05-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Encryption - Crypto 101</h3><div class="text-muted small"><p> It’s a write-up about the room : Try Hack Me - Room : Encryption - Crypto 101 Task 1 : Introduction</p></div></div></a></div><div class="card"> <a href="/posts/Bash-Scripting/"><div class="card-body"> <em class="timeago small" data-ts="1680998400" > 2023-04-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bash Scripting</h3><div class="text-muted small"><p> It’s a write-up about the room : Try Hack Me - Room : Bash Scripting Task 1 : Introduction ### What is bash? Bash is a scripting language that runs within the terminal on most Linux ...</p></div></div></a></div><div class="card"> <a href="/posts/Intro-to-Docker/"><div class="card-body"> <em class="timeago small" data-ts="1683072000" > 2023-05-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intro to Docker</h3><div class="text-muted small"><p> It’s a write-up about the room : Try Hack Me - Room : Intro to Docker Task 1 : Introduction In this room, you’ll get your first hands-on experience deploying and interacting with Docker container...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OWASP-Broken-Access-Control/" class="btn btn-outline-primary" prompt="Older"><p>Bash Scripting</p></a> <a href="/posts/x86-Architecture-Overview/" class="btn btn-outline-primary" prompt="Newer"><p>x86 Architecture Overview</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/bash/">Bash</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/note/">Note</a> <a class="post-tag" href="/tags/reference/">Reference</a> <a class="post-tag" href="/tags/wireshark/">Wireshark</a> <a class="post-tag" href="/tags/commands/">Commands</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/linux-commands/">Linux Commands</a> <a class="post-tag" href="/tags/linux-modules/">Linux Modules</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-T54PYY2P0N"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-T54PYY2P0N'); }); </script>
